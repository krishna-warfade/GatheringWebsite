<!DOCTYPE html>
<html class="no-js" lang="zxx">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>Antarang '25</title>
    <link rel="icon" type="image/x-icon" href="./img/gathering-logo.png" />
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- <link rel="manifest" href="site.webmanifest"> -->
    <link rel="shortcut icon" type="image/x-icon" href="img/favicon.png" />
    <!-- Place favicon.ico in the root directory -->

    <!-- CSS here -->
    <link rel="stylesheet" href="css/bootstrap.min.css" />
    <link rel="stylesheet" href="css/owl.carousel.min.css" />
    <link rel="stylesheet" href="css/magnific-popup.css" />
    <link rel="stylesheet" href="css/font-awesome.min.css" />
    <link rel="stylesheet" href="css/themify-icons.css" />
    <link rel="stylesheet" href="css/nice-select.css" />
    <link rel="stylesheet" href="css/flaticon.css" />
    <link rel="stylesheet" href="css/animate.css" />
    <link rel="stylesheet" href="css/slicknav.css" />
    <link rel="stylesheet" href="css/style.css" />
    <!-- <link rel="stylesheet" href="css/responsive.css"> -->

    <script src="https://unpkg.com/css-doodle@0.15.3/css-doodle.min.js"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/css-doodle/0.30.0/css-doodle.js"
      integrity="sha512-fAA616bYGXpn6N+kU+XbRHzH4JeCVKDal+oY5l8Iu6O0xGXg4rsKEfebpzJoURhRQvIZubmoWRxvBldfnNqouw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script>
      // Protect route
      window.onload = function () {
        const mis = localStorage.getItem("MIS");
        if (!mis) {
          alert("You must be logged in to access this page.");
          window.location.href = "../index.html";
        }
      };
    </script>
  </head>

  <body>
    <!--[if lte IE 9]>
      <p class="browserupgrade">
        You are using an <strong>outdated</strong> browser. Please
        <a href="https://browsehappy.com/">upgrade your browser</a> to improve
        your experience and security.
      </p>
    <![endif]-->

    <!-- header-start -->
    <header>
      <div class="header-area">
        <div id="sticky-header" class="main-header-area">
          <div class="container-fluid p-0">
            <div class="row align-items-center justify-content-between no-gutters">
              <div class="col-xl-2 col-lg-2">
                <div class="logo-img">
                  <a href="../main/index.html">
                    <img src="./img/gathering-logo.png" alt="" />
                  </a>
                </div>
              </div>
              <div class="col-xl-8 col-lg-8">
                <div class="main-menu d-none d-lg-block">
                  <nav>
                    <ul id="navigation">
                      <li><a class="active" href="../main/index.html">Home</a></li>
                      <li><a href="../events/events.html">Events</a></li>
                      <li><a href="../sports/sports.html">Sports</a></li>
                      <li><a href="../gallery2/gallery.html">Gallery</a></li>
                      <li><a href="../team/team.html">Team</a></li>
                      <li><a href="../contact/contact.html">Contact us</a></li>
                      <li><button id="logoutButton">Logout</button></li>
                    </ul>
                  </nav>
                </div>
              </div>
              <div class="col-12">
                <div class="mobile_menu d-block d-lg-none"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>
    <!-- header-end -->
    <!---->
    <!-- slider_area_start -->
   

    <!-- JS here -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>

    <div class="slider_area slider_bg_1">
      <div class="slider_text limited-div">
        <div class="box" id="confetti">
          <div class="title_text" id="titleh3">
            <h3>‚ÑÇùïÜùîº‚Ñô ùîæùî∏ùïã‚Ñçùîº‚ÑùùïÄ‚Ñïùîæ '25</h3>

            <!-- <a href="#" class="boxed-btn-white">Add to your Calendar</a> -->
          </div>

          <!-- <css-doodle use="var(--rule)"></css-doodle> -->
          <div class="container">
            <div class="position_relv">
              <h1 class="opcity_text d-none d-lg-block">GATHERING</h1>
              <!-- <div class = "tdimension">
                        <a href = "#">
                        </a>
                </div> -->
              <div class="outer_square">
                <div class="square" id="tilt"></div>
              </div>
              <div class="row">
                <div class="col-xl-9"></div>
              </div>
            </div>
          </div>
          <div class="container mt-5">
            <h3>Welcome to Antarang '25</h3>
            <button id="generateQrButton" class="btn btn-primary">Generate QR Code</button>
            <div id="qrcode" class="mt-3"></div>
          </div>
          <ul class="star">
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
          </ul>
          <button id="button" class="button-53" role="button">
            Celebrate!!!
          </button>
        </div>
      </div>
    </div>

    <!-- JS here -->
    <script src="js/vendor/modernizr-3.5.0.min.js"></script>
    <script src="js/vendor/jquery-1.12.4.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/isotope.pkgd.min.js"></script>
    <script src="js/ajax-form.js"></script>
    <script src="js/waypoints.min.js"></script>
    <script src="js/jquery.counterup.min.js"></script>
    <script src="js/imagesloaded.pkgd.min.js"></script>
    <script src="js/scrollIt.js"></script>
    <script src="js/jquery.scrollUp.min.js"></script>
    <script src="js/wow.min.js"></script>
    <script src="js/nice-select.min.js"></script>
    <script src="js/jquery.slicknav.min.js"></script>
    <script src="js/jquery.magnific-popup.min.js"></script>
    <script src="js/jquery.countdown.js"></script>
    <script src="js/plugins.js"></script>

    <!--contact js-->
    <script src="js/contact.js"></script>
    <script src="js/jquery.ajaxchimp.min.js"></script>
    <script src="js/jquery.form.js"></script>
    <script src="js/jquery.validate.min.js"></script>
    <script src="js/mail-script.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-confetti@latest/dist/js-confetti.browser.js"></script>
    <!-- <script src="script.js"></script> -->

    <script src="js/main.js"></script>

    <script>
      /* Store the element in el */
      let el = document.getElementById("tilt");

      /* Get the height and width of the element */
      const height = el.clientHeight;
      const width = el.clientWidth;

      /*
       * Add a listener for mousemove event
       * Which will trigger function 'handleMove'
       * On mousemove
       */
      el.addEventListener("mousemove", handleMove);

      /* Define function a */
      function handleMove(e) {
        /*
         * Get position of mouse cursor
         * With respect to the element
         * On mouseover
         */
        /* Store the x position */
        const xVal = e.layerX;
        /* Store the y position */
        const yVal = e.layerY;

        /*
         * Calculate rotation valuee along the Y-axis
         * Here the multiplier 20 is to
         * Control the rotation
         * You can change the value and see the results
         */
        const yRotation = 20 * ((xVal - width / 2) / width);

        /* Calculate the rotation along the X-axis */
        const xRotation = -20 * ((yVal - height / 2) / height);

        /* Generate string for CSS transform property */
        const string =
          "perspective(500px) scale(1.1) rotateX(" +
          xRotation +
          "deg) rotateY(" +
          yRotation +
          "deg)";

        /* Apply the calculated transformation */
        el.style.transform = string;
      }

      /* Add listener for mouseout event, remove the rotation */
      el.addEventListener("mouseout", function () {
        el.style.transform =
          "perspective(500px) scale(1) rotateX(0) rotateY(0)";
      });

      /* Add listener for mousedown event, to simulate click */
      el.addEventListener("mousedown", function () {
        el.style.transform =
          "perspective(500px) scale(0.9) rotateX(0) rotateY(0)";
      });

      /* Add listener for mouseup, simulate release of mouse click */
      el.addEventListener("mouseup", function () {
        el.style.transform =
          "perspective(500px) scale(1.1) rotateX(0) rotateY(0)";
      });
    </script>

    <script>
      const button = document.querySelector("#button");
      const canvas = document.querySelector("#confetti");
      const jsConfetti = new JSConfetti();

      // Function to add confetti
      function addConfetti() {
        jsConfetti
          .addConfetti({
            emojis: ["üéà", "‚ö°Ô∏è", "üí•", "‚ú®", "üí´", "üå∏"],
          })
          .then(() => jsConfetti.addConfetti());
      }

      // Automatically add confetti when the page loads
      // document.addEventListener('DOMContentLoaded', addConfetti);

      // Add confetti when the button is clicked
      button.addEventListener("click", addConfetti);
    </script>
    <script>
      document.getElementById("generateQrButton").addEventListener("click", async () => {
    const mis = localStorage.getItem("MIS");

    if (mis) {
      try {
        // Fetch student information from backend
        const response = await fetch(`https://gathering2025.onrender.com/api/student-info?mis=${mis}`, {
          method: "GET",
          headers: {
            "Content-Type": "application/json",
          },
        });

        if (!response.ok) {
          throw new Error("Failed to fetch student information.");
        }

        const studentInfo = await response.json();
        const { year, name, programme } = studentInfo; // Adjust based on your API response structure

        // Ensure the required information is present
        if (!year || !name || !programme) {
          throw new Error("Incomplete student information.");
        }

        const qrcodeContainer = document.getElementById("qrcode");
        qrcodeContainer.innerHTML = ""; // Clear any existing QR codes

        const canvas = document.createElement("canvas"); // Create a new canvas element
        qrcodeContainer.appendChild(canvas); // Append the canvas to the container

        // Create QR code data
        const qrData = JSON.stringify({mis, year});

        // Generate the QR code
        await QRCode.toCanvas(canvas, qrData, {
          width: 200,
          margin: 2,
        });
      } catch (error) {
        console.error("QR Code Generation Error:", error);
        alert("Failed to generate QR code. " + error.message);
      }
    } else {
      alert("MIS is missing. Please log in again.");
    }
  });


    
      document.getElementById("logoutButton").addEventListener("click", () => {
        localStorage.removeItem("MIS");
        alert("You have been logged out.");
        window.location.href = "../index.html";
      });
    </script>
    
  </body>
</html>
